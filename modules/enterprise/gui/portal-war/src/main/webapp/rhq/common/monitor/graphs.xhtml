<?xml version="1.0"?>

<!DOCTYPE html
      PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:rich="http://richfaces.ajax4jsf.org/rich"
      xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
      xmlns:onc="http://jboss.org/on/component"
      xmlns:onf="http://jboss.org/on/function">

<ui:composition>

<form id="metricViewsForm">

<table border="0" cellpadding="0" cellspacing="0" width="100%">
   <!-- chart actions -->
   <tr class="BlockContent">
       <td align="right">
           <ui:include src="measurement/views.xhtml"/>
       </td>
   </tr>

   <tr class="BlockContent">
       <td>
           <ui:include src="availability/data.xhtml"/>
       </td>
   </tr>

   <tr class="BlockContent">
      <td>
           <div id="indicatorDiv" style="width: 750px; height: 400px; border: 1; overflow-x: hidden; overflow-y: scroll;">
              <ui:include src="measurement/data.xhtml"/>
           </div>
       </td>
   </tr>

<tr class="BlockContent">
    <td width="550px">
        <div id="eventsDiv">
            <ui:include src="events/data.xhtml"/>
        </div>
    </td>
</tr>

<!-- spacer for date/time overlay, so it doesn't overlap metric display range -->
<tr class="BlockContent">
    <td>
        &nbsp;<br />
        &nbsp;<br />
    </td>
</tr>

<tr class="BlockContent">
    <td>
        <h:form id="MetricComponentForm">
            <input type="hidden" name="id" value="#{IndicatorChartsUIBean.context.resourceId}" />
            <input type="hidden" name="groupId" value="#{IndicatorChartsUIBean.context.groupId}" />
            <input type="hidden" name="parent" value="#{IndicatorChartsUIBean.context.parentResourceId}" />
            <input type="hidden" name="type" value="#{IndicatorChartsUIBean.context.resourceTypeId}" />
            <table>
                <tr>
                    <td><onc:metric optionList="m,h,d" /></td>
                    <td>
                        <h:commandLink rendered="#{not MetricComponentUtilityUIBean.readOnly}"
                                       action="#{MetricComponentUtilityUIBean.update}" >
                            <img src="/images/dash-button_go-arrow.gif" alt="Apply Metric Settings "/>
                        </h:commandLink>
                        <h:commandLink rendered="#{MetricComponentUtilityUIBean.readOnly}" 
                                       action="#{MetricComponentUtilityUIBean.switchToSimpleMode}">
                            <h:outputText value="Switch to Simple Mode" />
                        </h:commandLink>
                    </td>
                </tr>
            </table>
        </h:form>
    </td>
</tr>

<!-- footerDiv used purely for calculating the height for the overlay -->
<tr class="BlockContent">
    <td>
        <div id="footerDiv"></div>
    </td>
</tr> 
</table>

</form>

<script type="text/javascript">
    function maxIndicatorDivHeight() {
        var indicatorDiv = getElementCrossBrowser("indicatorDiv");
        var eventsDiv = getElementCrossBrowser("eventsDiv");
        var footerDiv = getElementCrossBrowser("footerDiv");
        
        var browserHeight = document.documentElement.clientHeight;
        var indicatorTopPos = getElementTopPos(indicatorDiv);
        var eventsTopPos = getElementTopPos(eventsDiv);
        var footerTopPos = getElementTopPos(footerDiv) ;
        var eventsDivHeight = footerTopPos - eventsTopPos;
        
        var newIndicatorDivHeight = browserHeight - indicatorTopPos - eventsDivHeight - 2; 
        indicatorDiv.style.height = newIndicatorDivHeight + "px"; 
    }
    
    addWindowOnLoadEvent(maxIndicatorDivHeight);
    addWindowOnResizeEvent(maxIndicatorDivHeight);
</script>
    
</ui:composition>

</html>
