<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:onc="http://jboss.org/on/component"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.ajax4jsf.org/rich">

<ui:composition template="/rhq/layout/main.xhtml">

    <ui:param name="pageTitle" value="Define Alert Notification Templates"/>

    <ui:define name="metaHeaders">
        <style>
            .col1, .col2 {
                vertical-align: top;
                padding: 10px;
            }

            .col2 {
                width: 100%;
            }

            #senderName {
                display: none;
            }
        </style>
    </ui:define>

    <ui:define name="breadcrumbs">
                Define Alert Notifications Templates
    </ui:define>

    <ui:define name="body">
        <br/>
        <h:messages showDetail="true"
                    globalOnly="true"
                    infoClass="InfoBlock"
                    warnClass="WarnBlock"
                    errorClass="ErrorBlock"
                    fatalClass="FatalBlock"
                    layout="table"
                />

        <h:panelGrid columns="2" width="100%" columnClasses="col1,col2">
            <rich:panel id="existingNotificationsPanel">
                <f:facet name="header">
                    <h:outputText>View / edit existing notification templates</h:outputText>
                </f:facet>
                <h:form id="templatesListForm">
                    <rich:scrollableDataTable value="#{notificationTemplatesUIBean.notificationTemplates}"
                                            var="template"
                                            selection="#{notificationTemplatesUIBean.selectedTemplates}"
                                            selectionMode="single"
                                            height="150px"
                                            onselectionchange="$('existingAlertsPanel').hide();">
                        <rich:column width="300px">
                            <f:facet name="header">
                                <h:outputText value="Name" />
                            </f:facet>
                            <h:outputText value="#{template.name}"/>
                        </rich:column>

                        <rich:column width="400px">
                            <f:facet name="header">
                                <h:outputText value="Description"/>
                            </f:facet>
                            <h:outputText value="#{template.description}" />
                        </rich:column>

                    </rich:scrollableDataTable>
                    <h:commandButton id="editTemplateButton"
                                   value="Edit selected Template"
                                   action="#{notificationTemplatesUIBean.editNotificationTemplate}"
                                   styleClass="buttonmed" />

                    <h:commandButton id="deleteTemplateButton"
                                   value="Delete selected Template"
                                   action="#{notificationTemplatesUIBean.deleteNotificationTemplate}"
                                   styleClass="buttonmed" />


                </h:form>
            </rich:panel>
            <rich:panel id="createNewTempaltePanel">
                <f:facet name="header">
                    <h:outputText><strong>Create new Template</strong></h:outputText>
                </f:facet>
                <h:form id="createNewTemplateForm">
                    <h:outputText>Name</h:outputText>
                    <br/>
                    <h:inputText id="newTemplateNameInput" required="true" maxlength="100" value="#{notificationTemplatesUIBean.newTemplateName}"/>
                    <p/>
                    <h:outputText>Description</h:outputText>
                    <br/>
                    <h:inputText id="newTemplateDescriptionInput" required="false" maxlength="100" value="#{notificationTemplatesUIBean.newTemplateDescription}"/>

                    <p/>
                    <h:commandButton id="newTemplateButton"
                                   value="Create new Template"
                                   action="#{notificationTemplatesUIBean.createNotificationTemplate}"
                                   styleClass="buttonmed"/>
                </h:form>
            </rich:panel>
        </h:panelGrid>

        <ui:include src="listAlertSender.xhtml">
            <ui:param name="redirect" value="/rhq/resource/alert/notif/notificationTemplates.xhtml?tid=#{param.tid}" />
        </ui:include>

        <c:if test="#{empty param.tid}">
            <script type="text/javascript">
                $('existingAlertsPanel').hide();
            </script>
        </c:if>
    </ui:define>
</ui:composition>

</html>
